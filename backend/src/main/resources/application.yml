spring:
  application:
    name: cultural-xinjiang

  datasource:
    url: jdbc:mysql://localhost:3306/cultural_xinjiang?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: .1.2.huchao
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        format_sql: true
    open-in-view: false

  # Redis 配置（可选）
  # 如果不需要 Redis，取消下面 autoconfigure.exclude 的注释
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
  redis:
    host: localhost
    port: 6379
    password:
    timeout: 6000
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0

  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB

# JWT Configuration
jwt:
  secret: xinjiang-digital-culture-platform-secret-key-2024
  expiration: 86400000 # 24 hours in milliseconds
  refresh-expiration: 604800000 # 7 days in milliseconds

# Aliyun OSS Configuration
aliyun:
  oss:
    endpoint: oss-cn-hangzhou.aliyuncs.com
    access-key-id: ${ALIYUN_ACCESS_KEY_ID:your-access-key-id}
    access-key-secret: ${ALIYUN_ACCESS_KEY_SECRET:your-access-key-secret}
    bucket-name: ${ALIYUN_BUCKET_NAME:cultural-xinjiang}
    url-prefix: https://cultural-xinjiang.oss-cn-hangzhou.aliyuncs.com

# Server Configuration
server:
  port: 8080
  servlet:
    context-path: /api

# Logging
logging:
  level:
    com.example.culturalxinjiang: DEBUG
    org.springframework.security: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/application.log

# SpringDoc OpenAPI
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

# 自定义应用配置
app:
  static:
    digital-images-dir: ${DIGITAL_IMAGES_DIR:../digital-images}
  routes:
    default-cover: ${server.servlet.context-path:}/digital-images/route.jpg

# AI Service Configuration
# 支持 OpenAI 和 DeepSeek，优先使用 DeepSeek（更便宜且国内访问更稳定）
# ⚠️ 注意：此文件中包含 API 密钥，请勿提交到公开的 Git 仓库
ai:
  provider: ${AI_PROVIDER:deepseek} # 可选: openai 或 deepseek
  deepseek:
    api-key: ${DEEPSEEK_API_KEY:your-deepseek-api-key}
    api-url: https://api.deepseek.com/v1/chat/completions
    model: deepseek-chat
    timeout: 120000 # 120 seconds，AI 生成路线需要更长时间
  openai:
    api-key: ${OPENAI_API_KEY:your-openai-api-key}
    api-url: https://api.openai.com/v1/chat/completions
    model: gpt-3.5-turbo
    timeout: 60000 # 60 seconds

